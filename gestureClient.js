var e=require("@babel/runtime/helpers/classCallCheck"),t=require("@babel/runtime/helpers/createClass"),s=require("./utils"),n=require("./request"),r=function(){function n(t,s){e(this,n),this.key=t,this.secret=s}return t(n,[{key:"sign",value:function(e){e=Object.assign({},e,{date:(new Date).getTime(),appKey:this.key});var t=Object.keys(e).sort().map((function(t){return"".concat(t).concat(e[t])})).concat(this.secret).join("");return e.signature=(0,s.sha1)(t),e}}]),n}(),i=function(){function i(t,s){e(this,i),s&&(0,n.setWxApi)(s),this.auth=new r(t.accessKey,t.accessSecret),this.host=t.clientHost}return t(i,[{key:"queryImage",value:function(e){var t=this,r={image:e=(0,s.data2base64)(e)},i=this.auth.sign(r);return new Promise((function(e,s){n.wxapi.request({url:"".concat(t.host),method:"post",data:i,success:function(t){return e(t.data)},fail:function(e){return s(e)}})}))}}]),i}();module.exports=i;