var n=require("@babel/runtime/helpers/classCallCheck"),e=require("@babel/runtime/helpers/createClass"),t=require("./request"),s=function(){function s(){n(this,s),this.tasks=[],this.running=0,this.runningMax=5}return e(s,[{key:"pushTask",value:function(n){this.tasks.push(n),this.run()}},{key:"dispose",value:function(){this.running=0,this.runningMax=5,this.tasks.splice(0,this.tasks.length)}},{key:"run",value:function(){var n=this;if(0!==this.tasks.length&&!(this.running>=this.runningMax)){this.running+=1;var e=this.tasks.shift();e.before&&setTimeout((function(n){return e.before()})),t.wxapi.request(Object.assign({},{responseType:e.responseType,url:e.networkPath},{success:function(n){setTimeout((function(t){return e.success(n.data)}))},fail:function(n){setTimeout((function(t){return e.fail(n)}))},complete:function(e){n.running-=1,setTimeout((function(e){return n.run()}),0)}}))}}}]),s}();module.exports=s;