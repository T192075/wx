require("../../common/vendor.js"),(global.webpackJsonp=global.webpackJsonp||[]).push([["pages/tickets/buytickets/home/home"],{"080c":function(e,n,t){t.r(n);var o=t("5e53"),a=t("c7a3");for(var r in a)["default"].indexOf(r)<0&&function(e){t.d(n,e,(function(){return a[e]}))}(r);t("5e35");var c=t("f0c5"),i=Object(c.a)(a.default,o.b,o.c,!1,null,"b76d7ad6",null,!1,o.a,void 0);n.default=i.exports},"38f6":function(e,n,t){(function(e,o){var a=t("4ea4");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=a(t("2eee")),c=a(t("c973")),i=a(t("9523")),u=t("fc36"),l=t("26cb"),s=t("f1c8"),m=t("b35a"),d=t("a887"),f=a(t("a78c")),g=a(t("2ef0"));function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function h(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach((function(n){(0,i.default)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var b=t("9210"),v="",P=null;n.default={components:{tabBar:function(){Promise.all([t.e("pages/tickets/common/vendor"),t.e("pages/tickets/components/tab-bar/tab-bar")]).then(function(){return resolve(t("b6dd"))}.bind(null,t)).catch(t.oe)},notice:function(){Promise.all([t.e("pages/tickets/common/vendor"),t.e("pages/tickets/components/notice/index")]).then(function(){return resolve(t("fb39"))}.bind(null,t)).catch(t.oe)},noticeModal:function(){Promise.all([t.e("pages/tickets/common/vendor"),t.e("pages/tickets/components/notice-modal/index")]).then(function(){return resolve(t("2d19"))}.bind(null,t)).catch(t.oe)},uiFit:function(){Promise.all([t.e("pages/tickets/common/vendor"),t.e("pages/tickets/components/ui-fit/index")]).then(function(){return resolve(t("a712"))}.bind(null,t)).catch(t.oe)}},data:function(){return{bannerList:[],currentIndex:0,showNoticeModal:!1,noticeData:{},isNotice:!1,noticeList:[],total:0,parkInfo:{nickName:"",subtitle:"",notice:""},containerHeight:0,showYearPack:!1,summary:"",content:"",pageMeta:{name:"购票首页",category:"推荐",type:"首页",column:"首页",plate:"首页"}}},computed:h({},(0,l.mapGetters)({buyer:"getMallBuyerData",showedNotice:"getShowedNotice",windowHeight:"windowHeight"})),mounted:function(){var n=this;e.createSelectorQuery().in(this).select(".buytickets-banner").boundingClientRect((function(e){n.containerHeight=n.windowHeight-e.height-84+43})).exec()},onReady:function(){return(0,c.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.default.get("mallOpenId")&&b.init({channel:"108994",openid:f.default.get("mallOpenId")},(function(e){console.log(e,"res init")}));case 1:case"end":return e.stop()}}),e)})))()},onShow:function(){P=new Date,console.log("onShow",P)},onUnload:function(){var e=new Date-P;console.log("onUnload",e),this.handleCommonUma("Um_Event_HomePageView",{Um_Key_Duration:e})},onHide:function(){var e=new Date-P;console.log("onHide",e),this.handleCommonUma("Um_Event_HomePageView",{Um_Key_Duration:e})},onLoad:function(e){var n=this;return(0,c.default)(r.default.mark((function t(){var o,a,c,i,u,l;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e,"******pages onload options*******"),t.next=3,(0,m.getBannerList)();case 3:return n.bannerList=t.sent,t.next=6,(0,m.getModalContentByCodeId)({advertCode:"home_notice"});case 6:return n.noticeData=t.sent,console.log("home_notice",n.noticeData),n.showedNotice||g.default.isEmpty(n.noticeData.content)?n.showNoticeModal=!1:(n.showNoticeModal=!0,n.setShowedNotice(!0)),t.next=11,(0,m.getMerchantParkInfo)({id:s.PARK_ID_MAIN});case 11:return n.parkInfo=t.sent,t.next=14,(0,m.getStrategyGridList)();case 14:return o=t.sent,a=o.rows,(c=o.total)>0&&a.forEach((function(e){n.noticeList.push({title:e.name})})),n.isNotice=c>0,t.next=21,(0,m.getMerchantParkInfo)({id:s.YEAR_PACK_ID});case 21:i=t.sent,n.showYearPack="T"===i.enabled,n.showYearPack&&(u=i.summary,l=i.content,n.summary=u,n.content=l);case 24:case"end":return t.stop()}}),t)})))()},onShareAppMessage:function(){return console.log("分享"),this.handleCommonUma("Um_Event_ShareButtonClick",{Um_Key_ButtonName:"购票首页分享"}),{title:"故宫博物院购票约展",path:u.PAGE_PATH.TICKETS_HOME,imageUrl:"".concat(s.COS_PATH,"/home_share_pic.png?type=icon")}},methods:h(h(h({},(0,l.mapMutations)(["setShowedNotice"])),(0,l.mapActions)(["pluginMallDecryptData","pluginMallContactsInfo","pluginMallLoginGetToken"])),{},{swiperChange:function(e){var n=e.detail.current;this.currentIndex=n},clickBanner:function(e){this.handleCommonUma("Um_Event_HomePageButtonClick",{Um_Key_ButtonName:"轮播图"}),console.log("----banner item",e),e.appId?o.navigateToMiniProgram({appId:e.appId,path:e.path}):e.customLinkurl&&(g.default.eq(e.title,"internal")?(0,u.navigateTo)(e.customLinkurl,{},"reLaunch"):(0,u.navigateTo)(u.PAGE_PATH.PAGE_WEBVIEW,{url:e.customLinkurl}))},clickNormal:function(){this.handleCommonUma("Um_Event_HomePageButtonClick",{Um_Key_ButtonName:"购票约展"}),v="normal",this.buyer.hasPhone&&this.goNormal()},goNormal:function(){(0,u.navigateTo)(u.PAGE_PATH.TICKETS_SELECT,{source:"normal"})},clickYear:function(){this.handleCommonUma("Um_Event_HomePageButtonClick",{Um_Key_ButtonName:"年票约展"}),v="year",this.buyer.hasPhone&&this.goYear()},goYear:function(){(0,u.navigateTo)(u.PAGE_PATH.TICKETS_SELECT,{source:"year"})},clickYearPackage:function(){console.log("点击年票套餐"),v="yearPack",this.buyer.hasPhone&&this.goyearPack()},goyearPack:function(){console.log("跳转年票套餐选择"),(0,u.navigateTo)(u.PAGE_PATH.YEAR_PACK_SELECT,{})},getPhoneNumber:function(n){var t=this;return(0,c.default)(r.default.mark((function o(){var a,c,i,u;return r.default.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if("getPhoneNumber:ok"!==n.detail.errMsg){o.next=18;break}return console.log(n,"同意授权"),console.log(v,"clickSource"),a=n.detail,c=a.encryptedData,i=a.iv,o.next=6,t.pluginMallDecryptData({data:c,iv:i});case 6:if(u=o.sent,"{}"!==JSON.stringify(u)){o.next=15;break}return e.hideLoading(),console.log("重新登录"),o.next=12,t.pluginMallLoginGetToken();case 12:return o.next=14,t.pluginMallDecryptData({data:c,iv:i});case 14:u=o.sent;case 15:return o.next=17,(0,d.putMallContactsPhone)({phone:u.phoneNumber});case 17:"normal"===v?t.goNormal():"year"===v?t.goYear():"yearPack"===v&&t.goyearPack();case 18:case"end":return o.stop()}}),o)})))()},goZhenBao:function(e){(0,u.navigateTo)(u.PAGE_PATH.TICKETS_BUYROOM,{source:"room",name:"hall"},!0)},goZhongBiao:function(e){(0,u.navigateTo)(u.PAGE_PATH.TICKETS_BUYROOM,{source:"room",name:"clock"},!0)},goDisplay:function(e){(0,u.navigateTo)(u.PAGE_PATH.TICKETS_BUYROOM,{source:"display",name:"pottery"},!0)}})}}).call(this,t("bc2e").default,t("543d").default)},"5e53":function(e,n,t){t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return r})),t.d(n,"a",(function(){return o}));var o={topBar:function(){return Promise.all([t.e("common/vendor"),t.e("pages/components/top-bar/index")]).then(t.bind(null,"6ebb"))},imageView:function(){return Promise.all([t.e("common/vendor"),t.e("pages/components/image-view/index")]).then(t.bind(null,"2ff9"))}},a=function(){this.$createElement;this._self._c},r=[]},c1a7:function(e,n,t){(function(e,n){var o=t("4ea4");t("6cdc"),o(t("66fd"));var a=o(t("080c"));e.__webpack_require_UNI_MP_PLUGIN__=t,n(a.default)}).call(this,t("bc2e").default,t("543d").createPage)},c7a3:function(e,n,t){t.r(n);var o=t("38f6"),a=t.n(o);for(var r in o)["default"].indexOf(r)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(r);n.default=a.a}},[["c1a7","common/runtime","common/vendor","pages/tickets/common/vendor"]]]);