<view class="selectroom data-v-edd0cb26">
    <top-bar bgColor="#F8F3E8" bind:__l="__l" class="data-v-edd0cb26" color="#3B2121" fixedSpacer="{{true}}" left="{{true}}" title="选择两馆及展览" vueId="07373704-1"></top-bar>
    <scroll-view class="selectroom-container data-v-edd0cb26" scrollY="{{showBottom}}" style="{{'height:'+height+'px'+';'}}">
        <view class="selectroom-date selectroom-box data-v-edd0cb26" wx:if="{{!isBuy}}">
            <view class="selectroom-date-item data-v-edd0cb26">{{'参观日期：'+reserve.selectData+' '+reserve.selectSchedule+''}}</view>
            <view class="selectroom-date-item data-v-edd0cb26" wx:if="{{source!=='year'}}">{{'联系方式：'+phone+''}}</view>
        </view>
        <view class="data-v-edd0cb26" wx:else>
            <view class="selectroom-ticket selectroom-box data-v-edd0cb26">
                <view class="selectroom-date-title data-v-edd0cb26">已购门票信息</view>
                <view class="{{['selectroom-date-ticket','data-v-edd0cb26',item.unableStatus?'gray':'']}}" wx:for="{{isBuyFreeList}}" wx:key="index">{{''+item.ticketName+''}}<block wx:if="{{item.isUsed}}">{{'('+(item.checkMobx.name||'已使用')+')'}}</block>
                    <text class="right data-v-edd0cb26">{{'x '+item.amount+'张'}}</text>
                </view>
                <view class="selectroom-date-line data-v-edd0cb26"></view>
                <view class="selectroom-date-item data-v-edd0cb26">{{'参观日期：'+(reserve.selectData||'')+'\n          '+(reserve.selectSchedule||'')+''}}</view>
            </view>
            <view class="selectroom-ticket selectroom-box data-v-edd0cb26" wx:if="{{childTicket.maxNum>0}}">
                <view class="selectroom-date-top data-v-edd0cb26">
                    <view class="selectroom-add-title data-v-edd0cb26">加购未成年人门票</view>
                    <view bindtap="__e" class="{{['data-v-edd0cb26','no-more',isMore?'more':'']}}" data-event-opts="{{[ [ 'tap',[ [ 'e0',['$event'] ] ] ] ]}}" hidden="{{!(childTicket.num>0)}}"></view>
                </view>
                <view class="selectroom-date-num data-v-edd0cb26">
                    <label class="_span data-v-edd0cb26" hidden="{{!(childTicket.num>0)}}">{{'已添加 '+childTicket.num+' 名观众信息'}}</label>
                </view>
                <view class="reserve-person-panel data-v-edd0cb26" hidden="{{!isMore}}">
                    <view class="reserve-type-item data-v-edd0cb26">
                        <view class="reserve-type-top data-v-edd0cb26">
                            <view class="reserve-type-name data-v-edd0cb26">{{''+childTicket.ticketNickName+''}}</view>
                            <view class="reserve-type-price data-v-edd0cb26">
                                <label class="reserve-type-unit _span data-v-edd0cb26">¥</label>
                                <label class="reserve-price-data _span data-v-edd0cb26">{{''+childTicket.price+''}}</label>
                            </view>
                        </view>
                        <view class="reserve-type-info data-v-edd0cb26">
                            <view class="reserve-type-left data-v-edd0cb26">
                                <view class="reserve-type-tips data-v-edd0cb26" wx:if="{{childTicket.modelExplain}}">
                                    <rich-text class="data-v-edd0cb26" nodes="{{childTicket.modelExplain}}"></rich-text>
                                </view>
                                <view bindtap="__e" class="reserve-type-notice data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleOpenBuytips',['$0'],['childTicket'] ] ] ] ]}}" wx:if="{{childTicket.bookRemind}}">购买须知</view>
                            </view>
                            <view class="reserve-type-num data-v-edd0cb26">
                                <view bindtap="__e" class="{{['data-v-edd0cb26','reserve-num-btn reserve-num-btn-dle',childTicket.num>0?'':'reserve-num-btn-disable reserve-num-dle-disable']}}" data-event-opts="{{[ [ 'tap',[ ['delTicketsNum'] ] ] ]}}"></view>
                                <view class="reserve-type-data data-v-edd0cb26">{{childTicket.num}}</view>
                                <view bindtap="__e" class="{{['data-v-edd0cb26','reserve-num-btn reserve-num-btn-add',childTicket.num>=childTicket.maxNum?'reserve-num-btn-disable reserve-num-add-disable':'']}}" data-event-opts="{{[ [ 'tap',[ ['addTicketsNum'] ] ] ]}}"></view>
                            </view>
                        </view>
                    </view>
                    <view class="reserve-home-box data-v-edd0cb26" wx:for="{{$root.l0}}" wx:for-index="personIndex" wx:for-item="personItem" wx:key="$orig">
                        <view class="reserve-home-header data-v-edd0cb26">
                            <view class="reserve-home-person-title data-v-edd0cb26">{{'未成年观众'+personIndex+1+''}}</view>
                            <view class="data-v-edd0cb26">
                                <view class="reserve-home-header-tag data-v-edd0cb26">未成年加购票</view>
                            </view>
                        </view>
                        <view class="reserve-home-person-content data-v-edd0cb26">
                            <view class="reserve-person-content-item data-v-edd0cb26" style="{{'align-items:'+(personItem[$orig].nameError?'flex-start':'center')+';'}}">
                                <view class="reserve-person-item-title data-v-edd0cb26">姓名</view>
                                <view class="data-v-edd0cb26">
                                    <view class="data-v-edd0cb26" style="position:relative;">
                                        <input alwaysEmbed="true" bindblur="__e" bindinput="__e" bindtap="__e" class="reserve-person-item-input data-v-edd0cb26" cursorSpacing="10" data-event-opts="{{[ [ 'tap',[ [ 'showSavePersons',[personIndex] ] ] ],[ 'input',[ [ '__set_model',[ '$0','name','$event',[] ],[ [ ['addData','',personIndex] ] ] ],[ 'hideSavePersons',[personIndex] ] ] ],[ 'blur',[ [ 'checkName',[personIndex] ] ] ] ]}}" disabled="{{inputDisable}}" maxlength="32" placeholder="请输入" placeholderStyle="color: #998A84;" type="text" value="{{personItem[$orig].name}}"></input>
                                        <view class="often-use-person data-v-edd0cb26" wx:if="{{personItem.g0}}">
                                            <view catchtap="__e" class="save-person-item data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'selectSaveUser',[personIndex,index,'$0'],[ [ ['savePersons','',index] ] ] ] ] ] ]}}" wx:for="{{savePersons}}" wx:key="index">
                                                <view class="data-v-edd0cb26">{{item.name+'，'+item.idCard}}</view>
                                            </view>
                                        </view>
                                    </view>
                                    <view class="error-info data-v-edd0cb26" wx:if="{{personItem[$orig].nameError}}">请输入正确的观众姓名</view>
                                </view>
                            </view>
                            <view class="reserve-person-content-item data-v-edd0cb26">
                                <view class="reserve-person-item-title data-v-edd0cb26">证件类型</view>
                                <view class="card-right data-v-edd0cb26">
                                    <view bindtap="__e" class="reserve-person-item-input data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'selectCardlist',[personIndex] ] ] ] ]}}">{{''+personItem[$orig].selectCardType.name+''}}</view>
                                    <view bindtap="__e" class="more-card data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'selectCardlist',[personIndex] ] ] ] ]}}"></view>
                                </view>
                            </view>
                            <view class="reserve-person-content-item data-v-edd0cb26" style="{{'align-items:'+(personItem[$orig].cardError?'flex-start':'center')+';'}}">
                                <view class="data-v-edd0cb26">
                                    <view class="reserve-person-item-title data-v-edd0cb26">证件号码</view>
                                </view>
                                <view class="data-v-edd0cb26">
                                    <input alwaysEmbed="true" bindblur="__e" bindinput="__e" class="reserve-person-item-input data-v-edd0cb26" cursorSpacing="10" data-event-opts="{{[ [ 'blur',[ [ 'handleCheckAllIn',['card','$0',personIndex],[ [ ['addData','',personIndex] ] ] ] ] ],[ 'input',[ [ '__set_model',[ '$0','idCard','$event',[] ],[ [ ['addData','',personIndex] ] ] ] ] ] ]}}" disabled="{{inputDisable||showOftenUse}}" placeholder="请输入" placeholderStyle="color: #998A84;" type="text" value="{{personItem[$orig].idCard}}"></input>
                                    <view class="error-info data-v-edd0cb26" wx:if="{{personItem[$orig].cardError}}">{{''+personItem[$orig].errorText+''}}</view>
                                </view>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
        <view class="selectroom-ticket selectroom-box data-v-edd0cb26">
            <view class="selectroom-ticket-title data-v-edd0cb26">选择两馆及展览</view>
            <view class="selectroom-ticket-user data-v-edd0cb26" wx:if="{{item[$orig].modelName}}" wx:for="{{$root.l1}}" wx:key="index">
                <view class="selectroom-ticket-user-info data-v-edd0cb26">
                    <view class="selectroom-ticket-user-name data-v-edd0cb26">{{''+item[$orig].userinfo.name+''}}</view>
                    <view bindtap="__e" class="selectroom-ticket-user-tip data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleOpenBuytips',['$0'],[ [ ['users','',index] ] ] ] ] ] ]}}" wx:if="{{source!=='year'}}">购买须知<image mode class="selectroom-ticket-user-icon data-v-edd0cb26" src="{{COS_PATH+'/icon-right-red.png'}}"></image>
                    </view>
                </view>
                <view class="selectroom-ticket-type data-v-edd0cb26" wx:if="{{!item[$orig].isBuyTicket}}">
                    <view class="selectroom-ticket-type-name data-v-edd0cb26">门票</view>
                    <view class="selectroom-ticket-type-box data-v-edd0cb26">
                        <view class="selectroom-ticket-type-ticketbox data-v-edd0cb26">
                            <view class="selectroom-ticket-type-ticket data-v-edd0cb26">
                                <ticket-box addTicket="{{item[$orig]}}" bind:__l="__l" class="data-v-edd0cb26" vueId="{{'07373704-2-'+index}}"></ticket-box>
                            </view>
                        </view>
                    </view>
                </view>
                <view class="selectroom-ticket-type data-v-edd0cb26" wx:if="{{source==='year'&&showEntryType==='T'}}">
                    <view class="selectroom-ticket-type-name type-add-year data-v-edd0cb26">
                        <block wx:if="{{item.m0>0}}">两馆</block>
                    </view>
                    <view class="selectroom-ticket-type-box data-v-edd0cb26">
                        <view class="year-ticket-type-wrap data-v-edd0cb26">
                            <view class="year-ticket-type-item data-v-edd0cb26" wx:for="{{item[$orig]._selectTickets}}" wx:for-index="typeIndex" wx:for-item="typeItem" wx:key="typeIndex">
                                <view bindtap="__e" class="check-box data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleYearSelectTicket',['$0','$1'],[ [ ['users','',index] ],[ ['users','',index],['_selectTickets','',typeIndex] ] ] ] ] ] ]}}">
                                    <view class="{{['data-v-edd0cb26','check-icon',typeItem.check?'checkone':'']}}">
                                        <image mode class="icon data-v-edd0cb26" hidden="{{!typeItem.check}}" src="{{COS_PATH+'/icon-check.png'}}"></image>
                                    </view>
                                    <view class="type-item-name data-v-edd0cb26">{{typeItem.nickName}}</view>
                                </view>
                            </view>
                        </view>
                        <view class="selectroom-ticket-type-ticketbox data-v-edd0cb26" wx:if="{{item[$orig].isSelectTicketType}}">
                            <view bindtap="__e" class="selectroom-ticket-type-ticket data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleCheckTicket',[index,addTicketi,'两馆'] ] ] ] ]}}" wx:for="{{item[$orig].mallInner}}" wx:for-index="addTicketi" wx:for-item="ticket" wx:key="addTicketi">
                                <ticket-box addTicket="{{ticket}}" bind:__l="__l" class="data-v-edd0cb26" vueId="{{'07373704-3-'+index+'-'+addTicketi}}"></ticket-box>
                            </view>
                        </view>
                    </view>
                </view>
                <view class="selectroom-ticket-type data-v-edd0cb26" wx:if="{{source!=='year'}}">
                    <view class="selectroom-ticket-type-name type-add-normal data-v-edd0cb26" wx:if="{{item.m1}}">两馆</view>
                    <view class="selectroom-ticket-type-box data-v-edd0cb26" wx:if="{{item.m2}}">
                        <view class="selectroom-ticket-type-ticket data-v-edd0cb26">主题开放日，如需购买两馆门票，请<view bindtap="__e" class="selectroom-ticket-type-tip data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleOpenUser',['$0'],[ [ ['users','',index] ] ] ] ] ] ]}}">补充身份信息</view>
                        </view>
                    </view>
                    <block wx:else>
                        <view class="selectroom-ticket-type-box data-v-edd0cb26" wx:if="{{item[$orig].ticketType==='3'&&item[$orig].selectTicketName}}">
                            <view class="selectroom-ticket-type-ticketbox data-v-edd0cb26">
                                <view bindtap="__e" class="selectroom-ticket-type-ticket data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleCheckTicket',[index,addTicketi,'两馆'] ] ] ] ]}}" wx:for="{{item[$orig].mallInner}}" wx:for-index="addTicketi" wx:for-item="ticket" wx:key="addTicketi">
                                    <ticket-box addTicket="{{ticket}}" bind:__l="__l" class="data-v-edd0cb26" vueId="{{'07373704-4-'+index+'-'+addTicketi}}"></ticket-box>
                                </view>
                            </view>
                            <view class="selectroom-ticket-type-text data-v-edd0cb26">点击可<view bindtap="__e" class="selectroom-ticket-type-tip data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleOpenUser',['$0'],[ [ ['users','',index] ] ] ] ] ] ]}}">修改身份信息</view>
                            </view>
                        </view>
                        <view class="selectroom-ticket-type-box data-v-edd0cb26" wx:else>
                            <view class="selectroom-ticket-type-ticketbox data-v-edd0cb26">
                                <view bindtap="__e" class="selectroom-ticket-type-ticket data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleCheckTicket',[index,addTicketi,'两馆'] ] ] ] ]}}" wx:for="{{item[$orig].mallInner}}" wx:for-index="addTicketi" wx:for-item="ticket" wx:key="addTicketi">
                                    <ticket-box addTicket="{{ticket}}" bind:__l="__l" class="data-v-edd0cb26" vueId="{{'07373704-5-'+index+'-'+addTicketi}}"></ticket-box>
                                </view>
                            </view>
                        </view>
                    </block>
                </view>
                <view class="selectroom-ticket-type data-v-edd0cb26" wx:if="{{item.m3>0}}">
                    <view class="selectroom-ticket-type-name type-show data-v-edd0cb26">展览</view>
                    <view class="selectroom-ticket-type-box data-v-edd0cb26">
                        <view class="selectroom-ticket-type-ticketbox data-v-edd0cb26">
                            <view bindtap="__e" class="selectroom-ticket-type-ticket data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleCheckTicket',[index,addTicketi,'展览'] ] ] ] ]}}" wx:for="{{item[$orig].mallShow}}" wx:for-index="addTicketi" wx:for-item="ticket" wx:key="addTicketi">
                                <view class="data-v-edd0cb26" style="margin-bottom:24rpx;">
                                    <ticket-box addTicket="{{ticket}}" bind:__l="__l" class="data-v-edd0cb26" isExhibition="{{true}}" vueId="{{'07373704-6-'+index+'-'+addTicketi}}"></ticket-box>
                                </view>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
    </scroll-view>
    <submit-order bind:__l="__l" bind:submit="__e" class="data-v-edd0cb26 vue-ref" data-event-opts="{{[ [ '^submit',[ ['handleSubmitOrder'] ] ] ]}}" data-ref="submitOrder" eventName="{{eventName}}" freeList="{{freeList}}" totalPrice="{{totalPrice}}" vueId="07373704-7"></submit-order>
    <uni-popup bind:__l="__l" class="selectroom-popup data-v-edd0cb26 vue-ref" data-ref="popupBuy" isMaskClick="{{false}}" safeArea="{{false}}" vueId="07373704-8" vueSlots="{{['default']}}">
        <view class="selectroom-popup-box data-v-edd0cb26">
            <view class="selectroom-popup-title data-v-edd0cb26">购买须知</view>
            <view class="selectroom-popup-content data-v-edd0cb26">
                <view class="selectroom-popup-content-text data-v-edd0cb26">
                    <rich-text class="data-v-edd0cb26" nodes="{{bookRemind}}"></rich-text>
                </view>
            </view>
            <view class="selectroom-popup-bottom data-v-edd0cb26">
                <button bindtap="__e" class="selectroom-popup-bottom-btn data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleCloseBuytips',['$event'] ] ] ] ]}}">关闭</button>
            </view>
        </view>
    </uni-popup>
    <uni-popup bind:__l="__l" class="selectroom-popup data-v-edd0cb26 vue-ref" data-ref="popupUser" isMaskClick="{{false}}" safeArea="{{false}}" vueId="07373704-9" vueSlots="{{['default']}}">
        <view class="selectroom-popup-box data-v-edd0cb26">
            <view class="selectroom-popup-title data-v-edd0cb26">选择票价类型<image mode bindtap="__e" class="selectroom-popup-close data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleCloseUser',['$event'] ] ] ] ]}}" src="{{COS_PATH+'/icon-close.png'}}"></image>
            </view>
            <view class="selectroom-popup-content data-v-edd0cb26" style="height:766rpx;">
                <view class="selectroom-popup-content-item data-v-edd0cb26">
                    <view class="selectroom-popup-content-user data-v-edd0cb26">{{selectName}}</view>
                    <view bindtap="__e" class="selectroom-popup-content-type data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleOpenTicket',['$event'] ] ] ] ]}}">
                        <text class="data-v-edd0cb26">票价类型<text class="data-v-edd0cb26" style="margin-left:48rpx;">{{''+(selectTicketName?selectTicketName:'请选择')+''}}</text>
                        </text>
                        <image mode class="selectroom-popup-content-right data-v-edd0cb26" src="{{COS_PATH+'/icon_right.png'}}"></image>
                    </view>
                </view>
            </view>
            <view bindtap="__e" class="selectroom-popup-bottom data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleCloseUser',['$event'] ] ] ] ]}}">
                <button class="{{['data-v-edd0cb26','selectroom-popup-bottom-btn',isCheckTicketType?'':'notclick']}}">确定</button>
            </view>
        </view>
    </uni-popup>
    <uni-popup bind:__l="__l" class="selectroom-popup data-v-edd0cb26 vue-ref" data-ref="popupTicket" isMaskClick="{{false}}" safeArea="{{false}}" vueId="07373704-10" vueSlots="{{['default']}}">
        <view class="selectroom-popup-box data-v-edd0cb26" style="padding-top:0;">
            <view class="selectroom-popup-content ticket data-v-edd0cb26">
                <view bindtap="__e" class="selectroom-popup-content-item data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleSelectTicket',[index] ] ] ] ]}}" wx:for="{{selectTickets}}" wx:key="index">
                    <view class="{{['data-v-edd0cb26',item.check?'selectroom-popup-content-tickettype check':'selectroom-popup-content-tickettype']}}">{{''+item.nickName+''}}</view>
                    <rich-text class="{{['data-v-edd0cb26',item.check?'selectroom-popup-content-ticketinfo check':'selectroom-popup-content-ticketinfo']}}" nodes="{{item.modelExplain}}"></rich-text>
                </view>
            </view>
            <view bindtap="__e" class="selectroom-popup-content-cancel data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'handleCloseTicket',['$event'] ] ] ] ]}}">取消</view>
        </view>
    </uni-popup>
    <uni-popup bind:__l="__l" class="popup-model data-v-edd0cb26 vue-ref" data-ref="popupCard" isMaskClick="{{false}}" safeArea="{{false}}" vueId="07373704-11" vueSlots="{{['default']}}">
        <view class="pop-box data-v-edd0cb26">
            <view class="pop-box-no-btn data-v-edd0cb26">
                <view bindtap="__e" class="{{['data-v-edd0cb26','card-item',item.name===addData[currentPersonIndex].selectCardType.name?'card-item-active':'']}}" data-event-opts="{{[ [ 'tap',[ [ 'onSelectCard',['$0'],[ [ ['cardList','',index] ] ] ] ] ] ]}}" wx:for="{{cardList}}" wx:key="index">{{''+item.name+''}}</view>
            </view>
            <view bindtap="__e" class="notice-close data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'closeTypePop',['$event'] ] ] ] ]}}">取消</view>
        </view>
    </uni-popup>
    <uni-popup bind:__l="__l" class="popup-model data-v-edd0cb26 vue-ref" data-ref="popupCheck" isMaskClick="{{false}}" safeArea="{{false}}" vueId="07373704-12" vueSlots="{{['default']}}">
        <view class="pop-model data-v-edd0cb26">
            <view class="pop-box data-v-edd0cb26">
                <view bindtap="__e" class="pop-close data-v-edd0cb26" data-event-opts="{{[ [ 'tap',[ [ 'closeCheckModel',['$event'] ] ] ] ]}}"></view>
                <view class="pop-top data-v-edd0cb26">
                    <view class="pop-title data-v-edd0cb26">验证身份</view>
                    <view class="pop-content data-v-edd0cb26" wx:if="{{$root.g1>0}}">
                        <view class="check-item data-v-edd0cb26" wx:for="{{checkList}}" wx:key="index">
                            <view class="check-person data-v-edd0cb26">
                                <view class="check-name data-v-edd0cb26">{{''+item.name+''}}</view>
                                <view class="check-type data-v-edd0cb26" wx:if="{{item.ticketName}}">{{''+item.ticketName+''}}</view>
                            </view>
                            <view class="check-card data-v-edd0cb26">
                                <view class="check-text data-v-edd0cb26">身份认证</view>
                                <view class="data-v-edd0cb26">
                                    <view class="check-status data-v-edd0cb26">
                                        <image class="check-image data-v-edd0cb26" src="{{item.checkCard?passImage:failImage}}"></image>
                                        <view class="check-status-text check-status-pass data-v-edd0cb26">{{''+(item.checkCard?'认证通过':'认证失败')+''}}</view>
                                    </view>
                                    <view class="check-resultMsg data-v-edd0cb26" wx:if="{{!item.checkCard}}">{{'('+item.resultMsg+')'}}</view>
                                </view>
                            </view>
                        </view>
                    </view>
                    <view class="pop-content data-v-edd0cb26" wx:else>{{errorMessage}}</view>
                </view>
            </view>
        </view>
    </uni-popup>
</view>
