<view class="person data-v-18d80a6e">
    <top-bar bgColor="{{app.theme.bgColor}}" bind:__l="__l" class="data-v-18d80a6e" color="#3B2121" fixedSpacer="{{true}}" left="{{true}}" title="填写观众信息" vueId="54babc78-1"></top-bar>
    <scroll-view class="reserve-home data-v-18d80a6e" scrollY="{{showBottom}}" style="{{'height:'+height+'px'+';'}}">
        <view class="reserve-content data-v-18d80a6e">
            <view class="reserve-home-panel data-v-18d80a6e">
                <view class="reserve-home-normal-year data-v-18d80a6e" wx:if="{{source!=='year'}}">
                    <view class="reserve-home-header-title data-v-18d80a6e">门票信息</view>
                    <view class="reserve-ticket-type-list data-v-18d80a6e">
                        <view class="reserve-type-item data-v-18d80a6e" wx:for="{{ticketsTypeLists}}" wx:for-index="__i0__" wx:key="*this">
                            <view class="reserve-type-offline data-v-18d80a6e">
                                <view class="reserve-type-name data-v-18d80a6e">{{''+item.nickName+''}}</view>
                                <view class="reserve-type-data data-v-18d80a6e" wx:if="{{source==='room'||source==='display'}}">{{'x '+item.data+'张'}}</view>
                            </view>
                            <view class="reserve-type-data data-v-18d80a6e" wx:if="{{source==='normal'}}">{{'x '+item.data+''}}<text class="data-v-18d80a6e" wx:if="{{source==='normal'}}">张</text>
                            </view>
                            <view class="reserve-type-price data-v-18d80a6e" wx:if="{{source==='room'||source==='display'}}">
                                <view class="reserve-type-unit data-v-18d80a6e">¥</view>
                                <view class="reserve-price-data data-v-18d80a6e">{{item.price}}</view>
                            </view>
                        </view>
                    </view>
                </view>
                <view class="reserve-home-normal-year data-v-18d80a6e">
                    <view class="reserve-time data-v-18d80a6e">
                        <view class="data-v-18d80a6e">
                            <label class="_span data-v-18d80a6e">参观日期：</label>
                            <label class="select-date _span data-v-18d80a6e">{{$root.m0}}</label>
                            <label class="select-play _span data-v-18d80a6e">{{selectSchedule}}</label>
                        </view>
                        <view bindtap="__e" class="update-time data-v-18d80a6e" data-event-opts="{{[ [ 'tap',[ [ 'backSelectDate',['$event'] ] ] ] ]}}" wx:if="{{source==='normal'||source==='year'}}">修改</view>
                    </view>
                    <view class="{{['data-v-18d80a6e','reserve-time tip',source==='year'?'year-tip':'']}}">请输入观众信息,每个订单最多5位观众<label class="_span data-v-18d80a6e" wx:if="{{source!=='year'}}">(含未成年人)</label>
                    </view>
                </view>
            </view>
            <view class="reserve-home-panel data-v-18d80a6e" wx:for="{{$root.l0}}" wx:for-index="personIndex" wx:for-item="personItem" wx:key="$orig">
                <view class="reserve-home-header data-v-18d80a6e">
                    <view class="reserve-home-person-title data-v-18d80a6e">{{'观众'+personIndex+1+''}}</view>
                    <view class="data-v-18d80a6e" wx:if="{{source!='display'}}">
                        <view class="reserve-home-header-tag data-v-18d80a6e">{{''+personItem[$orig].nickName+''}}</view>
                    </view>
                </view>
                <view class="reserve-home-person-content data-v-18d80a6e">
                    <view class="reserve-person-content-item data-v-18d80a6e" style="{{'align-items:'+(personItem[$orig].nameError?'flex-start':'center')+';'}}">
                        <view class="reserve-person-item-title data-v-18d80a6e">姓名</view>
                        <view class="data-v-18d80a6e">
                            <view class="data-v-18d80a6e" style="position:relative;">
                                <input alwaysEmbed="true" bindblur="__e" bindinput="__e" bindtap="__e" class="reserve-person-item-input data-v-18d80a6e" cursorSpacing="10" data-event-opts="{{[ [ 'tap',[ [ 'showSavePersons',[personIndex] ] ] ],[ 'input',[ [ '__set_model',[ '$0','name','$event',[] ],[ [ ['reserveData','',personIndex] ] ] ],[ 'hideSavePersons',[personIndex] ] ] ],[ 'blur',[ [ 'checkName',[personIndex] ] ] ] ]}}" disabled="{{inputDisable}}" maxlength="32" placeholder="请输入" placeholderStyle="color: #998A84;" type="text" value="{{personItem[$orig].name}}"></input>
                                <view class="often-use-person data-v-18d80a6e" wx:if="{{personItem.g0}}">
                                    <view catchtap="__e" class="save-person-item data-v-18d80a6e" data-event-opts="{{[ [ 'tap',[ [ 'selectSaveUser',[personIndex,index,'$0'],[ [ ['savePersons','',index] ] ] ] ] ] ]}}" wx:for="{{savePersons}}" wx:key="index">
                                        <view class="data-v-18d80a6e">{{item.name+'，'+item.idCard}}</view>
                                    </view>
                                </view>
                            </view>
                            <view class="error-info data-v-18d80a6e" wx:if="{{personItem[$orig].nameError}}">请输入正确的观众姓名</view>
                        </view>
                    </view>
                    <view class="reserve-person-content-item data-v-18d80a6e">
                        <view class="reserve-person-item-title data-v-18d80a6e">证件类型</view>
                        <view class="card-right data-v-18d80a6e">
                            <view bindtap="__e" class="reserve-person-item-input data-v-18d80a6e" data-event-opts="{{[ [ 'tap',[ [ 'selectCardlist',[personIndex] ] ] ] ]}}">{{''+personItem[$orig].selectCardType.name+''}}</view>
                            <view bindtap="__e" class="more-card data-v-18d80a6e" data-event-opts="{{[ [ 'tap',[ [ 'selectCardlist',[personIndex] ] ] ] ]}}"></view>
                        </view>
                    </view>
                    <view class="reserve-person-content-item data-v-18d80a6e" style="{{'align-items:'+(personItem[$orig].cardError?'flex-start':'center')+';'}}">
                        <view class="data-v-18d80a6e">
                            <view class="reserve-person-item-title data-v-18d80a6e">证件号码</view>
                        </view>
                        <view class="data-v-18d80a6e">
                            <input alwaysEmbed="true" bindblur="__e" bindinput="__e" bindtap="__e" class="reserve-person-item-input data-v-18d80a6e" cursorSpacing="10" data-event-opts="{{[ [ 'blur',[ [ 'handleCheckAllIn',['card','$0',personIndex],[ [ ['reserveData','',personIndex] ] ] ] ] ],[ 'tap',[ ['hideBottom'] ] ],[ 'input',[ [ '__set_model',[ '$0','idCard','$event',[] ],[ [ ['reserveData','',personIndex] ] ] ] ] ] ]}}" disabled="{{inputDisable||showOftenUse}}" placeholder="请输入" placeholderStyle="color: #998A84;" type="text" value="{{personItem[$orig].idCard}}"></input>
                            <view class="error-info data-v-18d80a6e" wx:if="{{personItem[$orig].cardError}}">请输入正确的证件号码</view>
                        </view>
                    </view>
                    <view class="year-ticket-info data-v-18d80a6e" wx:if="{{personItem[$orig].showYearInfo}}">
                        <view bindtap="__e" class="year-ticket-info-box data-v-18d80a6e" data-event-opts="{{[ [ 'tap',[ [ 'openPhoneModal',['$event'] ] ] ] ]}}" wx:if="{{personItem[$orig].roleError}}">
                            <label class="_span data-v-18d80a6e">非年票用户，如有疑问可</label>
                            <label class="contact-staff _span data-v-18d80a6e">联系客服</label>
                        </view>
                        <view class="year-ticket-info-box data-v-18d80a6e" wx:else>
                            <label class="_span data-v-18d80a6e">{{'年票用户，已使用('+personItem[$orig].hasNum+'/'+personItem[$orig].totalNum+')'}}</label>
                        </view>
                    </view>
                </view>
            </view>
            <view class="reserve-home-panel data-v-18d80a6e" wx:if="{{source!=='year'}}">
                <view class="reserve-person-content-item order-tel data-v-18d80a6e" style="{{'align-items:'+(phoneError?'flex-start':'center')+';'}}">
                    <view class="reserve-person-item-title data-v-18d80a6e">手机号码</view>
                    <view class="data-v-18d80a6e">
                        <input alwaysEmbed="true" bindblur="__e" bindinput="__e" bindtap="__e" class="reserve-person-item-input data-v-18d80a6e" cursorSpacing="10" data-event-opts="{{[ [ 'blur',[ [ 'handleCheckAllIn',['phone','$0'],['phone'] ] ] ],[ 'tap',[ ['hideBottom'] ] ],[ 'input',[ [ '__set_model',[ '','phone','$event',[] ] ] ] ] ]}}" disabled="{{inputDisable||showOftenUse}}" placeholder="用于接收订票信息" placeholderStyle="color: #998A84;" type="number" value="{{phone}}"></input>
                        <view class="error-info data-v-18d80a6e" wx:if="{{phoneError}}">请输入正确的手机号</view>
                    </view>
                </view>
            </view>
        </view>
    </scroll-view>
    <view class="{{['data-v-18d80a6e','reserve-footer',showBottom?'':'hide-bottom']}}" id="reserve-footer">
        <view class="reserve-total data-v-18d80a6e">
            <label class="_span data-v-18d80a6e">总计<label class="reserve-num _span data-v-18d80a6e">{{selectNum}}</label>张</label>
        </view>
        <view bindtap="__e" class="{{['data-v-18d80a6e','reserve-btn',allIn?'':'reserve-btn-disabled']}}" data-event-opts="{{[ [ 'tap',[ [ 'onConfirm',['$event'] ] ] ] ]}}" hoverClass="{{[selectDate&&selectTimeIndex!==-1?'reserve-btn-hover':'none']}}">确定</view>
    </view>
    <uni-popup bind:__l="__l" class="popup-model data-v-18d80a6e vue-ref" data-ref="popupCard" isMaskClick="{{false}}" safeArea="{{false}}" vueId="54babc78-2" vueSlots="{{['default']}}">
        <view class="pop-box data-v-18d80a6e">
            <view class="pop-box-no-btn data-v-18d80a6e">
                <view bindtap="__e" class="{{['data-v-18d80a6e','card-item',item.name===reserveData[currentPersonIndex].selectCardType.name?'card-item-active':'']}}" data-event-opts="{{[ [ 'tap',[ [ 'onSelectCard',['$0'],[ [ ['cardList','',index] ] ] ] ] ] ]}}" wx:for="{{cardList}}" wx:key="index">{{''+item.name+''}}</view>
            </view>
            <view bindtap="__e" class="notice-close data-v-18d80a6e" data-event-opts="{{[ [ 'tap',[ [ 'closeTypePop',['$event'] ] ] ] ]}}">取消</view>
        </view>
    </uni-popup>
    <uni-popup bind:__l="__l" class="popup-model data-v-18d80a6e vue-ref" data-ref="popupPhone" isMaskClick="{{false}}" safeArea="{{false}}" vueId="54babc78-3" vueSlots="{{['default']}}">
        <view class="phone-model data-v-18d80a6e">
            <view class="data-v-18d80a6e">
                <view class="phonePop-top data-v-18d80a6e">
                    <view bindtap="__e" class="phone-item data-v-18d80a6e" data-event-opts="{{[ [ 'tap',[ [ 'callStaffPhone',['$0'],[ [ ['staffPhoneList','',index] ] ] ] ] ] ]}}" wx:for="{{staffPhoneList}}" wx:key="index">{{''+item+''}}</view>
                </view>
                <view bindtap="__e" class="phonePop data-v-18d80a6e" data-event-opts="{{[ [ 'tap',[ [ 'closePhoneModal',['$event'] ] ] ] ]}}">取消</view>
            </view>
        </view>
    </uni-popup>
    <uni-popup bind:__l="__l" class="popup-model data-v-18d80a6e vue-ref" data-ref="popupCheck" isMaskClick="{{false}}" safeArea="{{false}}" vueId="54babc78-4" vueSlots="{{['default']}}">
        <view class="pop-model data-v-18d80a6e">
            <view class="pop-box data-v-18d80a6e">
                <view bindtap="__e" class="pop-close data-v-18d80a6e" data-event-opts="{{[ [ 'tap',[ [ 'closeCheckModel',['$event'] ] ] ] ]}}"></view>
                <view class="pop-top data-v-18d80a6e">
                    <view class="pop-title data-v-18d80a6e">验证身份</view>
                    <view class="pop-content data-v-18d80a6e" wx:if="{{$root.g1>0}}">
                        <view class="check-item data-v-18d80a6e" wx:for="{{checkList}}" wx:key="index">
                            <view class="check-person data-v-18d80a6e">
                                <view class="check-name data-v-18d80a6e">{{''+item.name+''}}</view>
                                <view class="check-type data-v-18d80a6e" wx:if="{{item.ticketName}}">{{''+item.ticketName+''}}</view>
                            </view>
                            <view class="check-card data-v-18d80a6e">
                                <view class="check-text data-v-18d80a6e">身份认证</view>
                                <view class="data-v-18d80a6e">
                                    <view class="check-status data-v-18d80a6e">
                                        <image class="check-image data-v-18d80a6e" src="{{item.checkCard?passImage:failImage}}"></image>
                                        <view class="check-status-text check-status-pass data-v-18d80a6e">{{''+(item.checkCard?'认证通过':'认证失败')+''}}</view>
                                    </view>
                                    <view class="check-resultMsg data-v-18d80a6e" wx:if="{{!item.checkCard}}">{{'('+item.resultMsg+')'}}</view>
                                </view>
                            </view>
                        </view>
                    </view>
                    <view class="pop-content data-v-18d80a6e" wx:else>{{errorMessage}}</view>
                </view>
                <view class="pop-btns data-v-18d80a6e">
                    <view bindtap="__e" class="pop-btn reject-btn data-v-18d80a6e" data-event-opts="{{[ [ 'tap',[ [ 'closeCheckModel',['$event'] ] ] ] ]}}">返回修改</view>
                    <view bindtap="__e" class="{{['data-v-18d80a6e','pop-btn','recept-btn',passed?'':'pop-btn-disable']}}" data-event-opts="{{[ [ 'tap',[ [ 'continuePay',['$event'] ] ] ] ]}}">下一步</view>
                </view>
            </view>
        </view>
    </uni-popup>
    <ticket-notice-modal bind:__l="__l" bind:hideNotice="__e" class="data-v-18d80a6e" data-event-opts="{{[ [ '^hideNotice',[ ['hideNotice'] ] ] ]}}" noticeData="{{noticeData}}" showNotice="{{showNoticeModal}}" vueId="54babc78-5"></ticket-notice-modal>
</view>
