require("../common/vendor.js"),(global.webpackJsonp=global.webpackJsonp||[]).push([["pages/building/detail/index"],{"3cf5":function(e,n,t){t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return i}));var i={topBar:function(){return Promise.all([t.e("common/vendor"),t.e("pages/components/top-bar/index")]).then(t.bind(null,"6ebb"))},imageView:function(){return Promise.all([t.e("common/vendor"),t.e("pages/components/image-view/index")]).then(t.bind(null,"2ff9"))},tmIcon:function(){return Promise.all([t.e("common/vendor"),t.e("components/tm-icon/index")]).then(t.bind(null,"f4eb"))},tmSpin:function(){return Promise.all([t.e("common/vendor"),t.e("components/tm-spin/index")]).then(t.bind(null,"3c6d"))}},o=function(){var e=this,n=(e.$createElement,e._self._c,e.ready?e.info.image_list&&e.info.image_list.length:null),t=e.ready&&n?e.info.image_list.length:null,i=e.ready&&n&&t>1?e.info.image_list.length:null,o=e.ready?e.__map(e.info.content,(function(n,t){return{$orig:e.__get_orig(n),g3:n?e.info.content.length:null}})):null,a=e.ready?e.recommendList&&e.recommendList.length:null;e.$mp.data=Object.assign({},{$root:{g0:n,g1:t,g2:i,l0:o,g4:a}})},a=[]},"46ca":function(e,n,t){t.r(n);var i=t("6fef"),o=t.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return i[e]}))}(a);n.default=o.a},"6fef":function(e,n,t){(function(e){var i=t("4ea4"),o=t("7037");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=i(t("2eee")),r=i(t("c973")),c=i(t("9523")),l=i(t("278c")),u=t("26cb"),d=t("ed08"),s=i(t("5d2d")),m=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var t=f(n);if(t&&t.has(e))return t.get(e);var i={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var c=a?Object.getOwnPropertyDescriptor(e,r):null;c&&(c.get||c.set)?Object.defineProperty(i,r,c):i[r]=e[r]}return i.default=e,t&&t.set(e,i),i}(t("3c18"));function f(e){if("function"!=typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(f=function(e){return e?t:n})(e)}function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function h(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach((function(n){(0,c.default)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}n.default={components:{slidePanel:function(){Promise.all([t.e("common/vendor"),t.e("pages/components/slide-panel/index")]).then(function(){return resolve(t("1881"))}.bind(null,t)).catch(t.oe)},commonTitle:function(){Promise.all([t.e("common/vendor"),t.e("pages/components/common-title/index")]).then(function(){return resolve(t("2370"))}.bind(null,t)).catch(t.oe)},buildingCard:function(){Promise.all([t.e("common/vendor"),t.e("pages/components/building-card/index")]).then(function(){return resolve(t("e67e"))}.bind(null,t)).catch(t.oe)},actionBar:function(){Promise.all([t.e("common/vendor"),t.e("pages/components/action-bar/index")]).then(function(){return resolve(t("8218"))}.bind(null,t)).catch(t.oe)}},data:function(){return{pageMeta:{name:"建筑详情页",category:"游故宫",type:"详情页",column:"故宫建筑",plate:""},attrArray:[],ready:!1,slideOpen:!1,location:null,currentIndex:0,isCollapse:!0,RecommendPool:"",recommendList:[],is_collect:!1,imgs:[],info:{}}},onLoad:function(e){var n=this,t=this.handleSceneToQueryArr(e.scene),i=(0,l.default)(t,1)[0];this.id=e.id||i,getApp().$vm.loginWX((function(){n.getDetail()}))},onShow:function(){},onShareAppMessage:function(){return{path:"/pages/building/detail/index?id=".concat(this.id),imageUrl:this.info.pic,title:this.info.name}},computed:h({},(0,u.mapState)({user:function(e){return e.user.info}})),methods:h(h(h({},(0,u.mapMutations)(["commonUpdate"])),(0,u.mapActions)(["setFavoriteAction"])),{},{handlePreviewImage:function(n){e.previewImage({showmenu:!1,urls:this.info.image_list,current:n})},handlePreview:function(n){e.previewImage({showmenu:!1,urls:[n]})},swiperChange:function(e){this.currentIndex=e.detail.current},slideChange:function(e){this.slideOpen=e},getDetail:function(){var e=this;this.is_collect=s.default.get("collect_".concat(this.id),!0);var n={code:this.id,open_id:this.user.open_id};m.buildingDetail(n).then((function(n){var t=n.data,i=t.content,o=t.dynasty,a=t.building_type,r=t.building_area;e.is_collect=1==t.is_collect,e.setAttrArray({label:"时代",value:o},{label:"分类",value:a},{label:"区域",value:r}),e.info=h(h({},t),{},{content:e.commonContentParse((0,d.pureHtmlToText)((0,d.htmlDecodeByRegExp)(i)))}),e.getRecommend(),e.ready=!0}))},setAttrArray:function(){for(var e=[],n=0;n<arguments.length;n++){var t=arguments[n];t.value&&e.push(t)}this.attrArray=e},onCollect:function(){this.is_collect=!this.is_collect,this.setFavoriteAction({open_id:this.user.open_id,data_id:this.id,collect_type:3,is_collect:this.is_collect?1:2}),this.handleCommonUma("Um_Event_BuildFavorite",{Um_Key_BuildName:this.info.name})},goShare:function(){var n=this.info,t=n.name,i=n.dynasty,o=n.litpic;this.commonUpdate({module:"home",type:"shareData",value:{name:t,desc:i,type:"建筑",pic:o,path:"pages/building/detail/index",scene:"".concat(this.id)}}),e.navigateTo({url:"/pages/pack/share/index?id=".concat(this.id)}),this.handleCommonUma("Um_Event_BuildShare",{Um_Key_BuildName:t,Um_Key_ShareMode:"生成分享卡片"})},shareFriend:function(){this.handleCommonUma("Um_Event_BuildShare",{Um_Key_BuildName:this.info.name,Um_Key_ShareMode:"微信分享"})},getRecommend:function(){var e=this;return(0,r.default)(a.default.mark((function n(){var t;return a.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.getRecLock){n.next=2;break}return n.abrupt("return");case 2:return e.getRecLock=!0,n.next=5,m.getBuildingRecommend({type_name:e.info.type_name});case 5:t=n.sent,e.recommendList=t.data,e.getRecLock=!1;case 8:case"end":return n.stop()}}),n)})))()},getRandomItem:function(){this.recommendList=(0,d.getRandomArrayElements)(this.list,3)},handleChangeRecommend:function(){this.getRecommend(),this.tarEvent("detail_building_recommend_change_click",{name:this.info.name,id:this.id})},getPoi:function(){var e=this;m.getPoiBySearch("".concat(this.info.name)).then((function(n){var t=n.data;t&&t.length&&(e.location=t[0].location,e.location_title=t[0].address)}))},openLocation:function(){var n=this.info.location,t=n.address,i=n.location;e.openLocation({name:this.info.name,address:t,scale:18,latitude:i.Lat,longitude:i.Lng}),this.tarEvent("detail_building_map_click",{name:this.info.name,id:this.id})},goBuilding:function(e){this.handleLinkRoute("/pages/building/detail/index?id=".concat(e," | redirect"))}})}}).call(this,t("543d").default)},"76a7":function(e,n,t){(function(e,n){var i=t("4ea4");t("6cdc"),i(t("66fd"));var o=i(t("b8f9"));e.__webpack_require_UNI_MP_PLUGIN__=t,n(o.default)}).call(this,t("bc2e").default,t("543d").createPage)},b8f9:function(e,n,t){t.r(n);var i=t("3cf5"),o=t("46ca");for(var a in o)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(a);t("634d");var r=t("f0c5"),c=Object(r.a)(o.default,i.b,i.c,!1,null,"a90770e2",null,!1,i.a,void 0);n.default=c.exports}},[["76a7","common/runtime","common/vendor","pages/building/common/vendor"]]]);